<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Agent Auth Protocol</title>
<meta content="Dick Hardt" name="author">
<meta content="
       Agent Auth (AAuth) is an authentication and authorization protocol for modern distributed systems. It provides progressive authentication from abuse prevention to full authorization, verified agent identity alongside user identity, cryptographic proof of resource legitimacy, and unified authentication and authorization in a single flow. The protocol uses HTTP Message Signatures for proof-of-possession on every request, eliminating bearer tokens and shared secrets. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="agent" name="keyword">
<meta content="authentication" name="keyword">
<meta content="authorization" name="keyword">
<meta content="http" name="keyword">
<meta content="signatures" name="keyword">
<meta content="draft-hardt-aauth-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.14.2
    ConfigArgParse 1.7.1
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-hardt-aauth.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">AAuth</td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt</td>
<td class="center">Expires 13 July 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TBD</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-aauth-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-09" class="published">9 January 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-07-13">13 July 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt</div>
<div class="org">Hellō</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Agent Auth Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Agent Auth (AAuth) is an authentication and authorization protocol for modern distributed systems. It provides progressive authentication from abuse prevention to full authorization, verified agent identity alongside user identity, cryptographic proof of resource legitimacy, and unified authentication and authorization in a single flow. The protocol uses HTTP Message Signatures for proof-of-possession on every request, eliminating bearer tokens and shared secrets.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 July 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-participants" class="internal xref">Participants</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-token-types" class="internal xref">Token Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-authentication-levels" class="internal xref">Authentication Levels</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-agent-auth-response-header" class="internal xref">Agent-Auth Response Header</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-signature-required" class="internal xref">Signature Required</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-identity-required" class="internal xref">Identity Required</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-authorization-required" class="internal xref">Authorization Required</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-agent-tokens" class="internal xref">Agent Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-agent-token-structure" class="internal xref">Agent Token Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-agent-token-usage" class="internal xref">Agent Token Usage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-resource-tokens" class="internal xref">Resource Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-resource-token-structure" class="internal xref">Resource Token Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-resource-token-usage" class="internal xref">Resource Token Usage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-auth-tokens" class="internal xref">Auth Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-auth-token-structure" class="internal xref">Auth Token Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-auth-token-usage" class="internal xref">Auth Token Usage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-metadata-documents" class="internal xref">Metadata Documents</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-agent-server-metadata" class="internal xref">Agent Server Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-auth-server-metadata" class="internal xref">Auth Server Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-resource-metadata" class="internal xref">Resource Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-http-message-signing-profil" class="internal xref">HTTP Message Signing Profile</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-required-headers" class="internal xref">Required Headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-signature-key-header" class="internal xref">Signature-Key Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-covered-components" class="internal xref">Covered Components</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-signature-parameters" class="internal xref">Signature Parameters</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-error-responses" class="internal xref">Error Responses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-error-response-format" class="internal xref">Error Response Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-error-codes" class="internal xref">Error Codes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-11.2.1" class="auto internal xref">11.2.1</a>.  <a href="#name-invalid_signature" class="internal xref">invalid_signature</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#section-11.2.2" class="auto internal xref">11.2.2</a>.  <a href="#name-invalid_agent_token" class="internal xref">invalid_agent_token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a href="#section-11.2.3" class="auto internal xref">11.2.3</a>.  <a href="#name-invalid_resource_token" class="internal xref">invalid_resource_token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a href="#section-11.2.4" class="auto internal xref">11.2.4</a>.  <a href="#name-invalid_auth_token" class="internal xref">invalid_auth_token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a href="#section-11.2.5" class="auto internal xref">11.2.5</a>.  <a href="#name-key_binding_failed" class="internal xref">key_binding_failed</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-proof-of-possession" class="internal xref">Proof-of-Possession</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-http-message-signature-secu" class="internal xref">HTTP Message Signature Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-token-security" class="internal xref">Token Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-well-known-uri-registration" class="internal xref">Well-Known URI Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-media-type-registrations" class="internal xref">Media Type Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-http-header-field-registrat" class="internal xref">HTTP Header Field Registrations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OAuth was created to replace the anti-pattern of users providing their passwords to applications to scrape their data from web sites. With OAuth, users could authorize an application to scoped access of their data without sharing their passwords. The internet has evolved significantly since the release of OAuth 2.0.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><strong>Security requirements have changed.</strong> Exfiltration of bearer tokens has become a common attack vector. While proof-of-possession with digital signatures is now practical and widely supported, bearer tokens and shared secrets are still used in most deployments.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><strong>Applications are distributed and more diverse.</strong> When OAuth 2.0 was created, the client was typically a server. Today it may also be one of many widely distributed instances of a desktop, mobile, or command line application where managing a single long lived shared secret or private key is impractical.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><strong>Agents have loosened the client-server model.</strong> Tightly bound, pre-registered client and server relationships are giving way to more open and dynamic ecosystems. In environments like the Model Context Protocol (MCP), a client may interact with any server, not just those it was pre-registered with.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><strong>Enterprise systems span multiple trust domains.</strong> Organizations deploy hundreds of applications across vendors, each requiring access to resources in different security contexts. Role-based authorization is often insufficient. Fine-grained, dynamic access control often requires verifying both the calling application and user's identity.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"><strong>OAuth scopes have become insufficient for modern authorization.</strong> Traditional OAuth scopes like read or write provide only coarse-grained labels that fail to convey what data will be accessed, under what conditions, for what purpose, or for how long. This opacity prevents meaningful user consent and makes it impossible to enforce least privilege.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"><strong>Resources have varying auth requirements.</strong> Resources need different levels of protection for different operations. Public endpoints rely on IP addresses for rate limiting and abuse prevention. Application identity is verified through IP whitelisting, mTLS, or long-lived credentials. Authorization uses API keys, manually provisioned tokens, or OAuth flows. These varying requirements have led to fragmented solutions.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><strong>Applications require both authentication and authorization.</strong> OAuth 2.0 provides authorization (delegated access). OpenID Connect provides authentication (user identity via SSO). Both protocols excel in their designed use cases, but applications often need both authentication and authorization in contexts where the separation creates friction.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">AAuth is an exploratory specification examining what new capabilities and features may be useful to address use cases that are not well-served by existing protocols like OAuth 2.0, OpenID Connect (OIDC), and SAML.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">{::boilerplate bcp14-tagged}<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3-1">
        <dt id="section-3-1.1">Agent</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.2">An application or software component acting on behalf of a user or autonomously. In AAuth, agents have cryptographic identity and make signed requests.<a href="#section-3-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.3">Agent Server</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.4">A server that manages agent identity and issues agent tokens to agent delegates. Identified by an HTTPS URL and publishes metadata at <code>/.well-known/aauth-agent</code>.<a href="#section-3-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.5">Agent Delegate</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.6">An instance of an agent that holds an agent token and makes requests on behalf of the agent. Each delegate has its own signing key and a unique <code>sub</code> identifier.<a href="#section-3-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.7">Agent Token</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.8">A JWT issued by an agent server to an agent delegate, binding the delegate's signing key to the agent's identity.<a href="#section-3-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.9">Auth Server</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.10">A server that authenticates users, obtains consent, and issues auth tokens. Publishes metadata at <code>/.well-known/aauth-issuer</code>.<a href="#section-3-1.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.11">Auth Token</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.12">A JWT issued by an auth server that grants an agent access to a resource, containing agent identity, user identity (if applicable), and authorized scopes.<a href="#section-3-1.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.13">Resource</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.14">A protected API or service that requires authentication and/or authorization. May publish metadata at <code>/.well-known/aauth-resource</code>.<a href="#section-3-1.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.15">Resource Token</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.16">A JWT issued by a resource that binds an access request to the resource's identity, preventing confused deputy attacks.<a href="#section-3-1.16" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="protocol-overview">
<section id="section-4">
      <h2 id="name-protocol-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-4-1">AAuth uses a three-party model where agents access resources with authorization from auth servers. All requests are signed using HTTP Message Signatures (<span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span>).<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="participants">
<section id="section-4.1">
        <h3 id="name-participants">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-participants" class="section-name selfRef">Participants</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-4.1-1.1">
            <strong>Agent</strong>: Makes signed requests to resources<a href="#section-4.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-1.2">
            <strong>Resource</strong>: Protected API that may require authentication or authorization<a href="#section-4.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.1-1.3">
            <strong>Auth Server</strong>: Issues auth tokens after authenticating users and obtaining consent<a href="#section-4.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="token-types">
<section id="section-4.2">
        <h3 id="name-token-types">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-token-types" class="section-name selfRef">Token Types</a>
        </h3>
<p id="section-4.2-1">AAuth defines three token types, all of which are proof-of-possession tokens:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.2-2.1">
            <strong>Agent Token</strong> (<code>agent+jwt</code>): Binds an agent delegate's key to an agent server's identity<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.2">
            <strong>Resource Token</strong> (<code>resource+jwt</code>): Binds an access request to a resource's identity<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.2-2.3">
            <strong>Auth Token</strong> (<code>auth+jwt</code>): Grants an agent access to a resource<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="authentication-levels">
<section id="section-4.3">
        <h3 id="name-authentication-levels">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-authentication-levels" class="section-name selfRef">Authentication Levels</a>
        </h3>
<p id="section-4.3-1">Resources can require different authentication levels via the <code>Agent-Auth</code> response header:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.3-2">
<li id="section-4.3-2.1">
            <strong>Pseudonymous</strong> (<code>httpsig</code>): Signed request proves consistent identity without verification<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">
            <strong>Identified</strong> (<code>httpsig; identity=?1</code>): Agent identity verified via JWKS or agent token<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.3">
            <strong>Authorized</strong> (<code>auth-token</code>): Full authorization with auth token<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="agent-auth-response-header">
<section id="section-5">
      <h2 id="name-agent-auth-response-header">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-agent-auth-response-header" class="section-name selfRef">Agent-Auth Response Header</a>
      </h2>
<p id="section-5-1">Resources use the <code>Agent-Auth</code> response header to indicate authentication requirements when returning 401 Unauthorized.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="signature-required">
<section id="section-5.1">
        <h3 id="name-signature-required">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-signature-required" class="section-name selfRef">Signature Required</a>
        </h3>
<p id="section-5.1-1">When a resource requires only a signed request:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-5.1-2">
<pre>HTTP/1.1 401 Unauthorized
Agent-Auth: httpsig
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="identity-required">
<section id="section-5.2">
        <h3 id="name-identity-required">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-identity-required" class="section-name selfRef">Identity Required</a>
        </h3>
<p id="section-5.2-1">When a resource requires verified agent identity:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-5.2-2">
<pre>HTTP/1.1 401 Unauthorized
Agent-Auth: httpsig; identity=?1
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-required">
<section id="section-5.3">
        <h3 id="name-authorization-required">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-authorization-required" class="section-name selfRef">Authorization Required</a>
        </h3>
<p id="section-5.3-1">When a resource requires an auth token:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-5.3-2">
<pre>HTTP/1.1 401 Unauthorized
Agent-Auth: httpsig; auth-token; resource_token="..."; auth_server="https://auth.example"
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">Parameters:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-4.1">
            <code>resource_token</code>: A resource token binding this request to the resource's identity<a href="#section-5.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.3-4.2">
            <code>auth_server</code>: The auth server URL where the agent should obtain an auth token<a href="#section-5.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="agent-tokens">
<section id="section-6">
      <h2 id="name-agent-tokens">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-agent-tokens" class="section-name selfRef">Agent Tokens</a>
      </h2>
<p id="section-6-1">Agent tokens enable agent servers to delegate signing authority to agent delegates while maintaining a stable agent identity.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="agent-token-structure">
<section id="section-6.1">
        <h3 id="name-agent-token-structure">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-agent-token-structure" class="section-name selfRef">Agent Token Structure</a>
        </h3>
<p id="section-6.1-1">An agent token is a JWT with <code>typ: agent+jwt</code> containing:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Header:
- <code>alg</code>: Signing algorithm
- <code>typ</code>: <code>agent+jwt</code>
- <code>kid</code>: Key identifier<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Payload:
- <code>iss</code>: Agent server URL (the agent identifier)
- <code>sub</code>: Agent delegate identifier (stable across key rotations)
- <code>cnf</code>: Confirmation claim with <code>jwk</code> containing the delegate's public key
- <code>iat</code>: Issued at timestamp
- <code>exp</code>: Expiration timestamp<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="agent-token-usage">
<section id="section-6.2">
        <h3 id="name-agent-token-usage">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-agent-token-usage" class="section-name selfRef">Agent Token Usage</a>
        </h3>
<p id="section-6.2-1">Agent delegates present agent tokens via the <code>Signature-Key</code> header using <code>scheme=jwt</code>:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-6.2-2">
<pre>Signature-Key: sig=jwt; jwt="eyJhbGciOiJFZERTQSIsInR5cCI6ImFnZW50K2p3dCJ9..."
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="resource-tokens">
<section id="section-7">
      <h2 id="name-resource-tokens">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-resource-tokens" class="section-name selfRef">Resource Tokens</a>
      </h2>
<p id="section-7-1">Resource tokens provide cryptographic proof of resource identity, preventing confused deputy and MITM attacks.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="resource-token-structure">
<section id="section-7.1">
        <h3 id="name-resource-token-structure">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-resource-token-structure" class="section-name selfRef">Resource Token Structure</a>
        </h3>
<p id="section-7.1-1">A resource token is a JWT with <code>typ: resource+jwt</code> containing:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Header:
- <code>alg</code>: Signing algorithm
- <code>typ</code>: <code>resource+jwt</code>
- <code>kid</code>: Key identifier<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Payload:
- <code>iss</code>: Resource URL
- <code>aud</code>: Auth server URL
- <code>agent</code>: Agent identifier
- <code>agent_jkt</code>: JWK thumbprint of the agent's current signing key
- <code>exp</code>: Expiration timestamp
- <code>scope</code>: Requested scopes (optional)<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resource-token-usage">
<section id="section-7.2">
        <h3 id="name-resource-token-usage">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-resource-token-usage" class="section-name selfRef">Resource Token Usage</a>
        </h3>
<p id="section-7.2-1">Resources include resource tokens in the <code>Agent-Auth</code> header when requiring authorization:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-7.2-2">
<pre>Agent-Auth: httpsig; auth-token; resource_token="eyJ..."; auth_server="https://auth.example"
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="auth-tokens">
<section id="section-8">
      <h2 id="name-auth-tokens">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-auth-tokens" class="section-name selfRef">Auth Tokens</a>
      </h2>
<p id="section-8-1">Auth tokens grant agents access to resources after authentication and authorization.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="auth-token-structure">
<section id="section-8.1">
        <h3 id="name-auth-token-structure">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-auth-token-structure" class="section-name selfRef">Auth Token Structure</a>
        </h3>
<p id="section-8.1-1">An auth token is a JWT with <code>typ: auth+jwt</code> containing:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Header:
- <code>alg</code>: Signing algorithm
- <code>typ</code>: <code>auth+jwt</code>
- <code>kid</code>: Key identifier<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Payload:
- <code>iss</code>: Auth server URL
- <code>aud</code>: Resource URL(s)
- <code>agent</code>: Agent identifier
- <code>cnf</code>: Confirmation claim with <code>jwk</code> containing the agent's public key
- <code>sub</code>: User identifier (if user-delegated access)
- <code>scope</code>: Authorized scopes
- <code>iat</code>: Issued at timestamp
- <code>exp</code>: Expiration timestamp<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="auth-token-usage">
<section id="section-8.2">
        <h3 id="name-auth-token-usage">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-auth-token-usage" class="section-name selfRef">Auth Token Usage</a>
        </h3>
<p id="section-8.2-1">Agents present auth tokens via the <code>Signature-Key</code> header using <code>scheme=jwt</code>:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div class="lang-http sourcecode" id="section-8.2-2">
<pre>Signature-Key: sig=jwt; jwt="eyJhbGciOiJFZERTQSIsInR5cCI6ImF1dGgrand0In0..."
</pre><a href="#section-8.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="metadata-documents">
<section id="section-9">
      <h2 id="name-metadata-documents">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-metadata-documents" class="section-name selfRef">Metadata Documents</a>
      </h2>
<p id="section-9-1">Participants publish metadata at well-known URLs to enable discovery.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="agent-server-metadata">
<section id="section-9.1">
        <h3 id="name-agent-server-metadata">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-agent-server-metadata" class="section-name selfRef">Agent Server Metadata</a>
        </h3>
<p id="section-9.1-1">Published at <code>/.well-known/aauth-agent</code>:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.1-2">
<pre>{
  "agent": "https://agent.example",
  "jwks_uri": "https://agent.example/.well-known/jwks.json"
}
</pre><a href="#section-9.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="auth-server-metadata">
<section id="section-9.2">
        <h3 id="name-auth-server-metadata">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-auth-server-metadata" class="section-name selfRef">Auth Server Metadata</a>
        </h3>
<p id="section-9.2-1">Published at <code>/.well-known/aauth-issuer</code>:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.2-2">
<pre>{
  "issuer": "https://auth.example",
  "agent_token_endpoint": "https://auth.example/token",
  "agent_auth_endpoint": "https://auth.example/authorize",
  "jwks_uri": "https://auth.example/.well-known/jwks.json"
}
</pre><a href="#section-9.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="resource-metadata">
<section id="section-9.3">
        <h3 id="name-resource-metadata">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-resource-metadata" class="section-name selfRef">Resource Metadata</a>
        </h3>
<p id="section-9.3-1">Published at <code>/.well-known/aauth-resource</code>:<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-9.3-2">
<pre>{
  "resource": "https://resource.example",
  "jwks_uri": "https://resource.example/.well-known/jwks.json",
  "additional_signature_components": ["content-type", "content-digest"]
}
</pre><a href="#section-9.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="http-message-signing-profile">
<section id="section-10">
      <h2 id="name-http-message-signing-profil">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-http-message-signing-profil" class="section-name selfRef">HTTP Message Signing Profile</a>
      </h2>
<p id="section-10-1">AAuth uses HTTP Message Signatures (<span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span>) for request authentication.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="required-headers">
<section id="section-10.1">
        <h3 id="name-required-headers">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-required-headers" class="section-name selfRef">Required Headers</a>
        </h3>
<p id="section-10.1-1">All AAuth requests MUST include:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.1-2.1">
            <code>Signature-Key</code>: Public key or key reference for signature verification<a href="#section-10.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.1-2.2">
            <code>Signature-Input</code>: Signature metadata including covered components<a href="#section-10.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.1-2.3">
            <code>Signature</code>: The HTTP message signature<a href="#section-10.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="signature-key-header">
<section id="section-10.2">
        <h3 id="name-signature-key-header">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-signature-key-header" class="section-name selfRef">Signature-Key Header</a>
        </h3>
<p id="section-10.2-1">The <code>Signature-Key</code> header (<span>[<a href="#I-D.hardt-httpbis-signature-key" class="cite xref">I-D.hardt-httpbis-signature-key</a>]</span>) provides keying material:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2-2.1">
            <code>scheme=hwk</code>: Header Web Key (inline public key)<a href="#section-10.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.2-2.2">
            <code>scheme=jwks_uri</code>: Reference to JWKS endpoint<a href="#section-10.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.2-2.3">
            <code>scheme=jwt</code>: JWT containing public key in <code>cnf</code> claim<a href="#section-10.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.2-2.4">
            <code>scheme=x509</code>: X.509 certificate<a href="#section-10.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="covered-components">
<section id="section-10.3">
        <h3 id="name-covered-components">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-covered-components" class="section-name selfRef">Covered Components</a>
        </h3>
<p id="section-10.3-1">HTTP Message Signatures in AAuth MUST cover:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.3-2.1">
            <code>@method</code>: HTTP method<a href="#section-10.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.3-2.2">
            <code>@authority</code>: Target host<a href="#section-10.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.3-2.3">
            <code>@path</code>: Request path<a href="#section-10.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.3-2.4">
            <code>signature-key</code>: The Signature-Key header value<a href="#section-10.3-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.3-3">Resources MAY require additional components via <code>additional_signature_components</code> in metadata.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-parameters">
<section id="section-10.4">
        <h3 id="name-signature-parameters">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-signature-parameters" class="section-name selfRef">Signature Parameters</a>
        </h3>
<p id="section-10.4-1">The <code>Signature-Input</code> header MUST include:<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.4-2.1">
            <code>created</code>: Signature creation timestamp (Unix time)<a href="#section-10.4-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.4-3">The <code>created</code> timestamp MUST NOT be more than 60 seconds in the past or future.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="error-responses">
<section id="section-11">
      <h2 id="name-error-responses">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
      </h2>
<p id="section-11-1">AAuth uses the OAuth 2.0 error response format (<span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> Section 5.2).<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="error-response-format">
<section id="section-11.1">
        <h3 id="name-error-response-format">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-error-response-format" class="section-name selfRef">Error Response Format</a>
        </h3>
<div class="lang-json sourcecode" id="section-11.1-1">
<pre>{
  "error": "invalid_request",
  "error_description": "Human-readable description"
}
</pre><a href="#section-11.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-codes">
<section id="section-11.2">
        <h3 id="name-error-codes">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-error-codes" class="section-name selfRef">Error Codes</a>
        </h3>
<div id="invalid-signature">
<section id="section-11.2.1">
          <h4 id="name-invalid_signature">
<a href="#section-11.2.1" class="section-number selfRef">11.2.1. </a><a href="#name-invalid_signature" class="section-name selfRef">invalid_signature</a>
          </h4>
<p id="section-11.2.1-1">The HTTP Message Signature is missing, malformed, or verification failed. When the signature is missing required components, the response SHOULD include <code>required_components</code>:<a href="#section-11.2.1-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-11.2.1-2">
<pre>{
  "error": "invalid_signature",
  "error_description": "Signature missing required components",
  "required_components": ["@method", "@authority", "@path", "signature-key"]
}
</pre><a href="#section-11.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="invalid-agent-token">
<section id="section-11.2.2">
          <h4 id="name-invalid_agent_token">
<a href="#section-11.2.2" class="section-number selfRef">11.2.2. </a><a href="#name-invalid_agent_token" class="section-name selfRef">invalid_agent_token</a>
          </h4>
<p id="section-11.2.2-1">The agent token is missing, malformed, expired, or signature verification failed.<a href="#section-11.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-resource-token">
<section id="section-11.2.3">
          <h4 id="name-invalid_resource_token">
<a href="#section-11.2.3" class="section-number selfRef">11.2.3. </a><a href="#name-invalid_resource_token" class="section-name selfRef">invalid_resource_token</a>
          </h4>
<p id="section-11.2.3-1">The resource token is missing, malformed, expired, or signature verification failed.<a href="#section-11.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="invalid-auth-token">
<section id="section-11.2.4">
          <h4 id="name-invalid_auth_token">
<a href="#section-11.2.4" class="section-number selfRef">11.2.4. </a><a href="#name-invalid_auth_token" class="section-name selfRef">invalid_auth_token</a>
          </h4>
<p id="section-11.2.4-1">The auth token is missing, malformed, expired, or signature verification failed.<a href="#section-11.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-binding-failed">
<section id="section-11.2.5">
          <h4 id="name-key_binding_failed">
<a href="#section-11.2.5" class="section-number selfRef">11.2.5. </a><a href="#name-key_binding_failed" class="section-name selfRef">key_binding_failed</a>
          </h4>
<p id="section-11.2.5-1">The key binding verification failed. The public key used to sign the request does not match the key bound in the token.<a href="#section-11.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="proof-of-possession">
<section id="section-12.1">
        <h3 id="name-proof-of-possession">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-proof-of-possession" class="section-name selfRef">Proof-of-Possession</a>
        </h3>
<p id="section-12.1-1">All AAuth tokens are proof-of-possession tokens. The holder must prove possession of the private key corresponding to the public key in the token's <code>cnf</code> claim.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-message-signature-security">
<section id="section-12.2">
        <h3 id="name-http-message-signature-secu">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-http-message-signature-secu" class="section-name selfRef">HTTP Message Signature Security</a>
        </h3>
<p id="section-12.2-1">HTTP Message Signatures provide:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-12.2-2">
<li id="section-12.2-2.1">
            <strong>Request Integrity</strong>: The signature covers HTTP method, target URI, and headers<a href="#section-12.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-12.2-2.2">
            <strong>Replay Protection</strong>: The <code>created</code> timestamp limits signature validity<a href="#section-12.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-12.2-2.3">
            <strong>Key Binding</strong>: Signatures are bound to specific keys via <code>Signature-Key</code><a href="#section-12.2-2.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="token-security">
<section id="section-12.3">
        <h3 id="name-token-security">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-token-security" class="section-name selfRef">Token Security</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-12.3-1.1">Agent tokens bind delegate keys to agent identity<a href="#section-12.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-12.3-1.2">Resource tokens bind access requests to resource identity, preventing confused deputy attacks<a href="#section-12.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-12.3-1.3">Auth tokens bind authorization grants to agent keys<a href="#section-12.3-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="well-known-uri-registrations">
<section id="section-13.1">
        <h3 id="name-well-known-uri-registration">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-well-known-uri-registration" class="section-name selfRef">Well-Known URI Registrations</a>
        </h3>
<p id="section-13.1-1">This specification registers the following Well-Known URIs:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-13.1-2.1">
            <code>aauth-agent</code>: Agent server metadata<a href="#section-13.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-13.1-2.2">
            <code>aauth-issuer</code>: Auth server metadata<a href="#section-13.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-13.1-2.3">
            <code>aauth-resource</code>: Resource metadata<a href="#section-13.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="media-type-registrations">
<section id="section-13.2">
        <h3 id="name-media-type-registrations">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-13.2-1">This specification registers the following media types:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-13.2-2.1">
            <code>application/agent+jwt</code>: Agent token<a href="#section-13.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-13.2-2.2">
            <code>application/auth+jwt</code>: Auth token<a href="#section-13.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-13.2-2.3">
            <code>application/resource+jwt</code>: Resource token<a href="#section-13.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="http-header-field-registrations">
<section id="section-13.3">
        <h3 id="name-http-header-field-registrat">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-http-header-field-registrat" class="section-name selfRef">HTTP Header Field Registrations</a>
        </h3>
<p id="section-13.3-1">This specification registers the following HTTP header:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-13.3-2.1">
            <code>Agent-Auth</code>: Authentication and authorization requirements<a href="#section-13.3-2.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.hardt-httpbis-signature-key">[I-D.hardt-httpbis-signature-key]</dt>
      <dd>
<span class="refAuthor">Hardt, D.</span> and <span class="refAuthor">T. Meunier</span>, <span class="refTitle">"HTTP Signature-Key Header"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hardt-httpbis-signature-key-00</span>, <time datetime="2026-01-07" class="refDate">7 January 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-hardt-httpbis-signature-key-00">https://datatracker.ietf.org/doc/html/draft-hardt-httpbis-signature-key-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9421">[RFC9421]</dt>
    <dd>
<span class="refAuthor">Backman, A., Ed.</span>, <span class="refAuthor">Richer, J., Ed.</span>, and <span class="refAuthor">M. Sporny</span>, <span class="refTitle">"HTTP Message Signatures"</span>, <span class="seriesInfo">RFC 9421</span>, <span class="seriesInfo">DOI 10.17487/RFC9421</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9421">https://www.rfc-editor.org/info/rfc9421</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The author would like to thank reviewers for their feedback on this specification.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt</span></div>
<div dir="auto" class="left"><span class="org">Hellō</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@hello.coop" class="email">dick.hardt@hello.coop</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
